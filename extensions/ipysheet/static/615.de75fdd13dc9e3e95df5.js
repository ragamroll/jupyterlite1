"use strict";(self.webpackChunkipysheet=self.webpackChunkipysheet||[]).push([[615],{5871:(e,t,n)=>{n.d(t,{up:()=>l,YM:()=>s,q8:()=>d});var o=n(6728),r=n(2876),a=n(6486),i=n(8657);class l{constructor(e){this.id=o.uuid(),this.code=e,this.execute_promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class s{constructor(){this.requests={},this.initialize()}execute(e){const t=new l(e);return this.requests[t.id]=t,this.worker.postMessage({id:t.id,code:t.code}),t.execute_promise}initialize(){const e=URL.createObjectURL(new Blob(["(",function(){const e=postMessage,t=addEventListener;(e=>{let t=this;const n=["Object","Function","Infinity","NaN","undefined","caches","TEMPORARY","PERSISTENT","Array","Boolean","Number","String","Symbol","Map","Math","Set"];do{Object.getOwnPropertyNames(t).forEach((e=>{-1===n.indexOf(e)&&delete t[e]})),t=Object.getPrototypeOf(t)}while(t!==Object.prototype)})(),t("message",(({data:t})=>{const n=new Function("",`return (${t.code}\n);`);e({id:t.id,result:n()},void 0)}))}.toString(),")()"],{type:"application/javascript"}));this.worker=new Worker(e),this.worker.onmessage=({data:e})=>{this.requests[e.id].resolve(e.result),delete this.requests[e.id]},this.worker.onerror=({message:e})=>{(0,a.forEach)(this.requests,(t=>{t.reject(e)})),this.requests={},this.worker.terminate(),this.initialize()},URL.revokeObjectURL(e)}}class d extends o.WidgetModel{defaults(){return Object.assign(Object.assign({},o.WidgetModel.prototype.defaults()),{_model_name:"RendererModel",_model_module:"ipysheet",_model_module_version:i.F,name:"",code:""})}initialize(e,t){super.initialize(e,t),this.kernel=new s;const n=this;this.rendering_function=function(e,t,o,a,i,l,s){r.renderers.TextRenderer.apply(this,arguments),n.kernel.execute(`(${n.get("code")})(${l})`).then((e=>{Object.assign(t.style,e)}))},r.renderers.registerRenderer(this.get("name"),this.rendering_function)}}},1448:(e,t,n)=>{n.r(t),n.d(t,{CellRangeModel:()=>d,RendererModel:()=>i.q8,SheetModel:()=>h,SheetView:()=>g});var o=n(6728),r=n(6486),a=n(8657),i=n(5871),l=n(2876),s=n.n(l);n(1035),n(1105),n(9259),l.cellTypes.registerCellType("widget",{renderer:async function(e,t,n,o,r,a,i){if(!t.hasAttribute("ghost-table")&&i.widget_view){let e=i.widget_view.el;1==t.children.length&&t.children[0]==e||(t.innerHTML="",e&&(t.appendChild(e),i.widget_view.trigger("displayed")))}}});let d=o.WidgetModel.extend({defaults:function(){return(0,r.extend)(d.__super__.defaults.call(this),{_model_name:"CellRangeModel",_model_module:"ipysheet",_model_module_version:a.F,value:null,row_start:1,column_start:1,row_end:1,column_end:1,type:null,name:null,style:{},renderer:null,read_only:!1,choice:null,squeeze_row:!0,squeeze_column:!0,transpose:!1,numeric_format:"0.000",date_format:"YYYY/MM/DD",time_format:"h:mm:ss a"})}},{serializers:(0,r.extend)({value:{deserialize:o.unpack_models}},o.WidgetModel.serializers)}),h=o.DOMWidgetModel.extend({defaults:function(){return(0,r.extend)(h.__super__.defaults.call(this),{_model_name:"SheetModel",_view_name:"SheetView",_model_module:"ipysheet",_view_module:"ipysheet",_model_module_version:a.F,_view_module_version:a.F,rows:3,columns:4,cells:[],named_cells:{},row_headers:!0,column_headers:!0,stretch_headers:"all",column_width:null,column_resizing:!0,row_resizing:!0,search_token:""})},initialize:function(){h.__super__.initialize.apply(this,arguments),this.data=[[]],this.update_data_grid(!1),this._updating_grid=!1,this.on("change:rows change:columns",this.update_data_grid,this),this.on("change:cells",this.on_change_cells,this),this.on("data_change",this.grid_to_cell,this),(0,r.each)(this.get("cells"),(e=>this.cell_bind(e))),this.cells_to_grid()},on_change_cells:function(){this._updating_grid=!0;try{let e=this.previous("cells"),t=this.get("cells");for(let n=0;n<t.length;n++){let o=t[n];(0,r.includes)(e,o)||this.cell_bind(o)}this.cells_to_grid()}finally{this._updating_grid=!1}this.grid_to_cell()},cell_bind:function(e){e.on_some_change(["value","style","type","renderer","read_only","choice","numeric_format","date_format","time_format"],(()=>{this.cells_to_grid()}))},cells_to_grid:function(){this.data=[[]],this.update_data_grid(!1),(0,r.each)(this.get("cells"),(e=>{this._cell_data_to_grid(e)})),this.trigger("data_change")},_cell_data_to_grid:function(e){e.get("value");for(let t=e.get("row_start");t<=e.get("row_end");t++)for(let n=e.get("column_start");n<=e.get("column_end");n++){let o=e.get("value"),a=t-e.get("row_start"),i=n-e.get("column_start");if(t>=this.data.length||n>=this.data[t].length)continue;let l=this.data[t][n];e.get("transpose")?(e.get("squeeze_column")||(o=o[i]),e.get("squeeze_row")||(o=o[a])):(e.get("squeeze_row")||(o=o[a]),e.get("squeeze_column")||(o=o[i])),null!=o&&(l.value=o),null!=e.get("type")&&(l.options.type=e.get("type")),null!=e.get("renderer")&&(l.options.renderer=e.get("renderer")),null!=e.get("read_only")&&(l.options.readOnly=e.get("read_only")),null!=e.get("choice")&&(l.options.source=e.get("choice")),e.get("numeric_format")&&"numeric"==e.get("type")&&(l.options.numericFormat={pattern:e.get("numeric_format")}),e.get("date_format")&&"date"==e.get("type")&&(l.options.correctFormat=!0,l.options.dateFormat=e.get("date_format")||l.options.dateFormat),e.get("time_format")&&"time"==e.get("type")&&(l.options.correctFormat=!0,l.options.timeFormat=e.get("time_format")||l.options.timeFormat),l.options.style=(0,r.extend)({},l.options.style,e.get("style"))}},grid_to_cell:function(){if(!this._updating_grid){this._updating_grid=!0;try{(0,r.each)(this.get("cells"),(e=>{let t=[];for(let n=e.get("row_start");n<=e.get("row_end");n++){let o=[];for(let t=e.get("column_start");t<=e.get("column_end");t++){if(n>=this.data.length||t>=this.data[n].length)continue;let e=this.data[n][t];o.push(e.value)}e.get("squeeze_column")&&(o=o[0]),t.push(o)}e.get("squeeze_row")&&(t=t[0]),e.get("transpose")?e.set("value",(0,r.unzip)(t)):e.set("value",t),e.save_changes()}))}finally{this._updating_grid=!1}}},update_data_grid:function(e=!0){let t=this.get("rows"),n=this.get("columns"),o=()=>({value:null,options:{}}),a=()=>(0,r.times)(this.get("columns"),o);if(t<this.data.length)this.data=this.data.slice(0,t);else if(t>this.data.length)for(let e=this.data.length;e<t;e++)this.data.push(a());for(let e=0;e<t;e++){let t=this.data[e];if(n<t.length)t=t.slice(0,n);else if(n>t.length)for(let e=t.length;e<n;e++)t.push({value:null,options:{}});this.data[e]=t}e&&this.trigger("data_change")}},{serializers:(0,r.extend)({cells:{deserialize:o.unpack_models},data:{deserialize:o.unpack_models}},o.DOMWidgetModel.serializers)}),c=function(e,t){return(0,r.map)(e,(function(e){return(0,r.map)(e,(function(e){return e[t]}))}))};s().renderers.registerRenderer("styled",(function(e,t,n,o,a,i,l){let d=l.original_renderer||l.type||"text",h=s().renderers.getRenderer(d);h.apply(this,arguments),(0,r.each)(l.style,(function(e,n){t.style[n]=e}))}));let g=o.DOMWidgetView.extend({render:function(){this.widget_views={},this.el.classList.add("handsontable"),this.el.classList.add("jupyter-widgets"),this.table_container=document.createElement("div"),this.el.appendChild(this.table_container),this._table_constructed=this.displayed.then((async()=>{this.hot=await this._build_table(),this.model.on("data_change",this.on_data_change,this),this.model.on("change:column_headers change:row_headers",this._update_hot_settings,this),this.model.on("change:stretch_headers change:column_width",this._update_hot_settings,this),this.model.on("change:column_resizing change:row_resizing",this._update_hot_settings,this),this.model.on("change:search_token",this._search,this),this._search()}))},processPhosphorMessage:function(e){switch(g.__super__.processPhosphorMessage.apply(this,arguments),e.type){case"resize":case"after-show":this._table_constructed.then((()=>{this.hot.render(),this.hot._refreshBorders(null)}))}},async _build_widgets_views(){let e=this.model.data,t=e.length,n=e[0].length,r={};for(let o=0;o<t;o++)for(let t=0;t<n;t++){let n=[o,t].join();if(e[o][t]&&"widget"==e[o][t].options.type){let a=e[o][t].value,i=this.widget_views[n];i&&(i.model.cid==a.cid?r[n]=Promise.resolve(i):(i.remove(),i=null)),!i&&a&&(r[n]=this.create_child_view(a))}}for(let t in this.widget_views)if(this.widget_views.hasOwnProperty(t)){let[n,o]=String(t).split(",").map((e=>parseInt(e))),r=this.widget_views[t];e[n][o]&&e[n][o].value&&e[n][o].value.cid==r.model.cid||r.remove()}this.widget_views=await o.resolvePromisesDict(r)},async _build_table(){return await this._build_widgets_views(),new(s())(this.table_container,(0,r.extend)({data:this._get_cell_data(),rowHeaders:!0,colHeaders:!0,search:!0,columnSorting:{sortEmptyCells:!1,indicator:!0,headerAction:!0,compareFunctionFactory:this._compareFunctionFactory},cells:(...e)=>this._cell(...e),afterChange:(e,t)=>{this._on_change(e,t)},afterRemoveCol:(e,t)=>{this._on_change_grid(e,t)},afterRemoveRow:(e,t)=>{this._on_change_grid(e,t)}},this._hot_settings()))},_compareFunctionFactory:function(e,t){return function(t,n){let r,a;return"desc"==e?(r=t,a=n):(r=n,a=t),r instanceof o.WidgetModel&&(r=r.get("value")),a instanceof o.WidgetModel&&(a=a.get("value")),null==r||null==a?0:r<a?-1:r>a?1:0}},_update_hot_settings:function(){this.hot.updateSettings(this._hot_settings())},_hot_settings:function(){return{colHeaders:this.model.get("column_headers"),rowHeaders:this.model.get("row_headers"),stretchH:this.model.get("stretch_headers"),colWidths:this.model.get("column_width")||void 0,manualColumnResize:this.model.get("column_resizing"),manualRowResize:this.model.get("row_resizing")}},_search:function(e=!0,t=!1){let n=this.model.get("search_token");t&&""==n||(this.hot.getPlugin("search").query(n),e&&this.hot.render())},_get_cell_data:function(){return c(this.model.data,"value")},_cell:function(e,t){let n=this.model.data,o=(0,r.cloneDeep)(n[e][t].options);return e<n.length&&t<n[e].length||console.error("cell out of range"),null==o.type&&delete o.type,null==o.style&&delete o.style,null==o.source&&delete o.source,"renderer"in o&&(o.original_renderer=o.renderer),o.renderer="styled",this.widget_views[[e,t].join()]&&(o.widget_view=this.widget_views[[e,t].join()]),o},_on_change_grid:function(e,t){let n=this.hot.getSourceDataArray();this.model.set({rows:n.length,columns:n[0].length}),this.model.save_changes()},_on_change:function(e,t){if(void 0!==this.hot&&"loadData"!=t&&"ObserveChanges.change"!=t){if("alter"==t){let e=this.hot.getSourceDataArray();return this.model.set({rows:e.length,columns:e[0].length}),void this.model.save_changes()}!function(e,t){for(let n=0;n<Math.min(e.length,t.length);n++)for(let o=0;o<Math.min(e[n].length,t[n].length);o++)e[n][o].value=t[n][o]}(this.model.data,this.hot.getSourceDataArray()),this.model.trigger("data_change")}},on_data_change:function(){this._last_data_set=new Promise((async(e,t)=>{let n=c(this.model.data,"value"),o=n.length,r=n[0].length,a=this.hot.countRows(),i=this.hot.countCols();o>a&&this.hot.alter("insert_row",o-1,o-a),o<this.hot.countRows()&&this.hot.alter("remove_row",o-1,a-o),r>i&&this.hot.alter("insert_col",r-1,r-i),r<i&&this.hot.alter("remove_col",r-1,i-r),await this._build_widgets_views(),this.hot.loadData(n),this.hot.updateSettings({colHeaders:!0,rowHeaders:!0}),this.hot.updateSettings({colHeaders:this.model.get("column_headers"),rowHeaders:this.model.get("row_headers")}),this._search(!1,!0),this.hot.render(),e(void 0)}))},set_cell:function(e,t,n){this.hot.setDataAtCell(e,t,n)},get_cell:function(e,t){return this.hot.getDataAtCell(e,t)}})},8657:(e,t,n)=>{n.d(t,{i:()=>o,F:()=>r});let o=n(4147).i8,r="~"+o},1150:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(3645),r=n.n(o)()((function(e){return e[1]}));r.push([e.id,"/* handsontable layout*/\n\n/* These properties can be overridden with the Layout widget.\n *\n *  - overflow: hidden;\n *   the first parent element with defined dimension and overflow: hidden is considered as the container for the spreadsheet\n *\n *  - height: 250px;\n *   we used a fixed value in pixels for the the natural height because `auto` yields a zero-height table in the Jupyter notebook.\n *\n */\n .handsontable.jupyter-widgets {\n    overflow: hidden;\n    height: 250px;\n }\n \n /* handsontable theme */\n .p-Widget .handsontable .table caption + thead tr:first-child th,\n .p-Widget .handsontable .table caption + thead tr:first-child td,\n .p-Widget .handsontable .table colgroup + thead tr:first-child th,\n .p-Widget .handsontable .table colgroup + thead tr:first-child td,\n .p-Widget .handsontable .table thead:first-child tr:first-child th,\n .p-Widget .handsontable .table thead:first-child tr:first-child td {\n   border-top: 1px solid var(--jp-border-color1);\n }\n \n .p-Widget .handsontable .table-bordered th:first-child,\n .p-Widget .handsontable .table-bordered td:first-child {\n   border-left: 1px solid var(--jp-border-color1);\n }\n \n .p-Widget .handsontable tr {\n   background-color: var(--jp-layout-color0);\n }\n \n .p-Widget .handsontable .table-striped > tbody > tr:nth-of-type(even) {\n   background-color: var(--jp-layout-color0);\n }\n \n .p-Widget .handsontable th,\n .p-Widget .handsontable td {\n   background-color: var(--jp-layout-color0);\n   color: var(--jp-content-font-color0);\n   font-size: var(--jp-ui-font-size1);\n   font-family: var(--jp-ui-font-family);\n   border-right: 1px solid var(--jp-border-color2);\n   border-bottom: 1px solid var(--jp-border-color2);\n }\n \n .p-Widget .handsontable td.htInvalid {\n   background-color: var(--jp-error-color0) !important; /*gives priority over td.area selection background*/\n }\n \n .p-Widget .handsontable th:last-child {\n   border-right: 1px solid var(--jp-border-color2);\n   border-bottom: 1px solid var(--jp-border-color2);\n }\n \n .p-Widget .handsontable tr:first-child th.htNoFrame,\n .p-Widget .handsontable th:first-child.htNoFrame,\n .p-Widget .handsontable th.htNoFrame {\n   background-color: var(--jp-layout-color0);\n }\n \n .p-Widget .handsontable th {\n   background-color: var(--jp-layout-color2);\n   color: var(--jp-content-font-color0);\n }\n \n .p-Widget .handsontable th.active {\n   background-color: var(--jp-layout-color3);\n }\n \n .p-Widget .handsontable .manualColumnResizer:hover,\n .p-Widget .handsontable .manualColumnResizer.active,\n .p-Widget .handsontable .manualRowResizer:hover,\n .p-Widget .handsontable .manualRowResizer.active {\n   background-color: var(--jp-brand-color1);\n }\n \n .p-Widget .handsontable .manualColumnResizerGuide {\n   background-color: var(--jp-brand-color1);\n }\n \n .p-Widget .handsontable .manualRowResizerGuide {\n   background-color: var(--jp-brand-color1);\n }\n \n .p-Widget .handsontable td.area:before,\n .p-Widget .handsontable td.area-1:before,\n .p-Widget .handsontable td.area-2:before,\n .p-Widget .handsontable td.area-3:before,\n .p-Widget .handsontable td.area-4:before,\n .p-Widget .handsontable td.area-5:before,\n .p-Widget .handsontable td.area-6:before,\n .p-Widget .handsontable td.area-7:before {\n   background-color: var(--jp-brand-color2);\n }\n \n .p-Widget .handsontable tbody th.ht__highlight,\n .p-Widget .handsontable thead th.ht__highlight {\n   background-color: var(--jp-layout-color3);\n }\n \n .p-Widget .handsontable tbody th.ht__active_highlight,\n .p-Widget .handsontable thead th.ht__active_highlight {\n   background-color: var(--jp-brand-color1);\n   color: white;\n }\n \n .p-Widget .handsontableInput {\n   box-shadow: 0 0 0 2px var(--jp-brand-color0) inset;\n   color: var(--jp-content-font-color0);\n   background-color: var(--jp-layout-color0);\n }\n \n .p-Widget .handsontable.listbox .ht_master table {\n   border: 1px solid var(--jp-border-color2);\n   background-color: var(--jp-layout-color0);\n }\n \n .p-Widget .handsontable.listbox tr td.current,\n .p-Widget .handsontable.listbox tr:hover td {\n   background-color: var(--jp-layout-color1);\n }\n \n .p-Widget .handsontable td.htSearchResult {\n   background: var(--jp-accent-color1);\n   color: white;\n }\n \n .p-Widget .htBordered.htTopBorderSolid {\n   border-top-color: var(--jp-border-color2);\n }\n .p-Widget .htBordered.htRightBorderSolid {\n   border-right-color: var(--jp-border-color2);\n }\n .p-Widget .htBordered.htBottomBorderSolid {\n   border-bottom-color: var(--jp-border-color2);\n }\n .p-Widget .htBordered.htLeftBorderSolid {\n   border-left-color: var(--jp-border-color2);\n }\n \n .p-Widget .handsontable tbody tr th:nth-last-child(2) {\n   border-right: 1px solid var(--jp-border-color2);\n }\n \n .p-Widget .handsontable thead tr:nth-last-child(2) th.htGroupIndicatorContainer {\n   border-bottom: 1px solid var(--jp-border-color2);\n }\n \n .p-Widget .ht_clone_top_left_corner thead tr th:nth-last-child(2) {\n   border-right: 1px solid var(--jp-border-color2);\n }\n \n .p-Widget .handsontable .wtBorder.current {\n   background-color: var(--jp-brand-color0) !important;\n   border-color: var(--jp-layout-color0) !important;\n }\n \n .p-Widget .handsontable .wtBorder.area {\n   background-color: var(--jp-brand-color0) !important;\n   border-color: var(--jp-layout-color0) !important;\n }\n \n /* Pikaday styling */\n .pika-single {\n     color: var(--jp-content-font-color0);\n     background: var(--jp-layout-color0);\n     border: 1px solid var(--jp-border-color2);\n     border-bottom-color: var(--jp-border-color2);\n     font-family: var(--jp-ui-font-family);\n }\n \n .pika-label {\n     background-color: var(--jp-layout-color0);\n }\n \n .pika-table th {\n     color: var(--jp-content-font-color1);\n }\n \n .pika-button {\n     color: var(--jp-content-font-color2);\n     background: var(--jp-layout-color2);\n }\n \n .pika-week {\n     font-size: var(--jp-ui-font-size1);\n     color: var(--jp-content-font-color1);\n }\n \n .is-today .pika-button {\n     color: var(--jp-content-font-color2);\n }\n \n .is-selected .pika-button {\n     color: var(--jp-layout-color0);\n     background: var(--jp-layout-color2);\n     box-shadow: inset 0 1px 3px var(--jp-brand-color0)\n }\n \n .is-inrange .pika-button {\n     background: var(--jp-brand-color1)\n }\n \n .is-startrange .pika-button {\n     color: var(--jp-layout-color0);\n     background: var(--jp-layout-color2);\n }\n \n .is-endrange .pika-button {\n     color: var(--jp-layout-color0);\n     background: var(--jp-layout-color2);\n }\n \n .is-disabled .pika-button,\n .is-outside-current-month .pika-button {\n     color: var(--jp-content-font-color1);\n }\n \n .pika-button:hover {\n     color: var(--jp-layout-color0);\n     background: var(--jp-layout-color2);\n }\n \n .pika-prev,\n .pika-next {\n     background-color: var(--jp-layout-color2);\n }\n ",""]);const a=r},9259:(e,t,n)=>{var o=n(3379),r=n.n(o),a=n(7795),i=n.n(a),l=n(569),s=n.n(l),d=n(3565),h=n.n(d),c=n(9216),g=n.n(c),u=n(4589),p=n.n(u),_=n(1150),A={};A.styleTagTransform=p(),A.setAttributes=h(),A.insert=s().bind(null,"head"),A.domAPI=i(),A.insertStyleElement=g(),r()(_.Z,A),_.Z&&_.Z.locals&&_.Z.locals},4333:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAYAAAAsEj5rAAAAU0lEQVR42u3VOwoAMAgE0dwfAnNjU26bYkBCFGwfiL9VVWoO+BJ4Gf3gtsEKKoFBNTCoCAYVwaAiGNQGMUHMkjGbgjk2mIONuXo0nC8XnCf1JXgArVIZAQh5TKYAAAAASUVORK5CYII="},168:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAYAAAAsEj5rAAAAUklEQVR42u3VMQoAIBADQf8Pgj+OD9hG2CtONJB2ymQkKe0HbwAP0xucDiQWARITIDEBEnMgMQ8S8+AqBIl6kKgHiXqQqAeJepBo/z38J/U0uAHlaBkBl9I4GwAAAABJRU5ErkJggg=="},1276:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAoCAMAAADJ7yrpAAAAKlBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKE86IAAAADXRSTlMABBEmRGprlJW72e77tTkTKwAAAFJJREFUeAHtzjkSgCAQRNFmQYUZ7n9dKUvru0TmvPAn3br0QfgdZ5xx6x+rQn23GqTYnq1FDcnuzZIO2WmedVqIRVxgGKEyjNgYRjKGkZ1hFIZ3I70LyM0VtU8AAAAASUVORK5CYII="},3525:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAoCAMAAADJ7yrpAAAAKlBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKE86IAAAADXRSTlMABBEmRGprlJW72e77tTkTKwAAAFNJREFUeAHtzjkSgCAUBNHPgsoy97+ulGXRqJE5L+xkxoYt2UdsLb5bqFINz+aLuuLn5rIu2RkO3fZpWENimNgiw6iBYRTPMLJjGFxQZ1hxxb/xBI1qC8k39CdKAAAAAElFTkSuQmCC"},4147:e=>{e.exports={i8:"0.5.0"}}}]);